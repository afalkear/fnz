<% if @business.present? && @business.persisted? %>
<p>Contacts:
<ul class="nav nav-pills nav-stacked">
  <% @business.contacts.each do |contact| %>
      <% if contact.membership.present? %>
        <% str = contact.name.html_safe + ( content_tag(:i, "", :class => "#{contact.membership.due? ? 'due' : 'overdue'}-membership pull-right icon-fire") + content_tag(:span, contact.membership.try(:ends_on), :class => "pull-right") if contact.membership.due? || contact.membership.overdue? )  %>
        <li class="<%= 'active' if @membership.present? && contact.id == @membership.contact.id %>"><%= link_to str, business_membership_path(@business, contact.membership) %></li>
      <% else %>
          <li><%= link_to contact.name.html_safe + content_tag(:i, "", :class => "no-membership pull-right icon-fire", :title => "Assign membership"), new_business_membership_path(@business, :membership => {:contact_id => contact.id}) %></li>
      <% end %>
  <% end %>
</ul>
</p>
<% end %>